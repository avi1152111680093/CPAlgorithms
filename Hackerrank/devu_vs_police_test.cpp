#include <bits/stdc++.h>

typedef long long LL;

using namespace std;

LL gcd(LL a, LL b)
{
    while (b)
    {
        a %= b;
        swap(a, b);
    }

    return a;
}

long long mod_mult(long long a, long long b, long long c)
{
    a %= c;
    long long ret = 0;

    while (b)
    {
        if (b & 1)
        {
            ret += a;
            if (ret >= c)
                ret -= c;
        }

        a <<= 1;
        if (a >= c)
            a -= c;
        b >>= 1;
    }

    return ret;
}

LL phi(LL n)
{
    LL result = n;
    for (LL i = 2; i * i <= n; i++)
    {
        if (n % i == 0)
        {
            while (n % i == 0)
                n /= i;
            result -= result / i;
        }
    }
    if (n > 1)
        result -= result / n;
    return result;
}

LL binmodpow(LL a, LL n, LL m)
{
    LL ans = 1;
    LL pow = a;
    while (n)
    {
        if (n & 1)
            ans = (ans * pow) % m;
        pow = (pow * pow) % m;
        n >>= 1;
    }

    return ans % m;
}

LL solve(LL n1, LL k1, LL n2, LL k2, LL n)
{
    if (k1 == 0)
        return 1 % n;
    if (n2 == 1 || k2 == 0)
        return binmodpow(n1, k1, n);
    if (n1 == 0 || n1 % n == 0)
        return 0;
    if (k2 == 1)
        return binmodpow(n1, k1 * n2, n);

    LL phi_n = phi(n);

    LL temp = mod_mult(k1 % phi_n, binmodpow(n2, k2, phi_n), phi_n);
    LL ans = binmodpow(n1, phi_n + temp, n);

    return ans % n;
}

int main()
{

    vector<vector<int>> input = {{0, 0, 0, 0, 1},
                                 {0, 0, 0, 0, 2},
                                 {0, 0, 0, 0, 3},
                                 {0, 0, 0, 1, 1},
                                 {0, 0, 0, 1, 2},
                                 {0, 0, 0, 1, 3},
                                 {0, 0, 0, 2, 1},
                                 {0, 0, 0, 2, 2},
                                 {0, 0, 0, 2, 3},
                                 {0, 0, 1, 0, 1},
                                 {0, 0, 1, 0, 2},
                                 {0, 0, 1, 0, 3},
                                 {0, 0, 1, 1, 1},
                                 {0, 0, 1, 1, 2},
                                 {0, 0, 1, 1, 3},
                                 {0, 0, 1, 2, 1},
                                 {0, 0, 1, 2, 2},
                                 {0, 0, 1, 2, 3},
                                 {0, 0, 2, 0, 1},
                                 {0, 0, 2, 0, 2},
                                 {0, 0, 2, 0, 3},
                                 {0, 0, 2, 1, 1},
                                 {0, 0, 2, 1, 2},
                                 {0, 0, 2, 1, 3},
                                 {0, 0, 2, 2, 1},
                                 {0, 0, 2, 2, 2},
                                 {0, 0, 2, 2, 3},
                                 {0, 1, 0, 0, 1},
                                 {0, 1, 0, 0, 2},
                                 {0, 1, 0, 0, 3},
                                 {0, 1, 0, 1, 1},
                                 {0, 1, 0, 1, 2},
                                 {0, 1, 0, 1, 3},
                                 {0, 1, 0, 2, 1},
                                 {0, 1, 0, 2, 2},
                                 {0, 1, 0, 2, 3},
                                 {0, 1, 1, 0, 1},
                                 {0, 1, 1, 0, 2},
                                 {0, 1, 1, 0, 3},
                                 {0, 1, 1, 1, 1},
                                 {0, 1, 1, 1, 2},
                                 {0, 1, 1, 1, 3},
                                 {0, 1, 1, 2, 1},
                                 {0, 1, 1, 2, 2},
                                 {0, 1, 1, 2, 3},
                                 {0, 1, 2, 0, 1},
                                 {0, 1, 2, 0, 2},
                                 {0, 1, 2, 0, 3},
                                 {0, 1, 2, 1, 1},
                                 {0, 1, 2, 1, 2},
                                 {0, 1, 2, 1, 3},
                                 {0, 1, 2, 2, 1},
                                 {0, 1, 2, 2, 2},
                                 {0, 1, 2, 2, 3},
                                 {0, 2, 0, 0, 1},
                                 {0, 2, 0, 0, 2},
                                 {0, 2, 0, 0, 3},
                                 {0, 2, 0, 1, 1},
                                 {0, 2, 0, 1, 2},
                                 {0, 2, 0, 1, 3},
                                 {0, 2, 0, 2, 1},
                                 {0, 2, 0, 2, 2},
                                 {0, 2, 0, 2, 3},
                                 {0, 2, 1, 0, 1},
                                 {0, 2, 1, 0, 2},
                                 {0, 2, 1, 0, 3},
                                 {0, 2, 1, 1, 1},
                                 {0, 2, 1, 1, 2},
                                 {0, 2, 1, 1, 3},
                                 {0, 2, 1, 2, 1},
                                 {0, 2, 1, 2, 2},
                                 {0, 2, 1, 2, 3},
                                 {0, 2, 2, 0, 1},
                                 {0, 2, 2, 0, 2},
                                 {0, 2, 2, 0, 3},
                                 {0, 2, 2, 1, 1},
                                 {0, 2, 2, 1, 2},
                                 {0, 2, 2, 1, 3},
                                 {0, 2, 2, 2, 1},
                                 {0, 2, 2, 2, 2},
                                 {0, 2, 2, 2, 3},
                                 {1, 0, 0, 0, 1},
                                 {1, 0, 0, 0, 2},
                                 {1, 0, 0, 0, 3},
                                 {1, 0, 0, 1, 1},
                                 {1, 0, 0, 1, 2},
                                 {1, 0, 0, 1, 3},
                                 {1, 0, 0, 2, 1},
                                 {1, 0, 0, 2, 2},
                                 {1, 0, 0, 2, 3},
                                 {1, 0, 1, 0, 1},
                                 {1, 0, 1, 0, 2},
                                 {1, 0, 1, 0, 3},
                                 {1, 0, 1, 1, 1},
                                 {1, 0, 1, 1, 2},
                                 {1, 0, 1, 1, 3},
                                 {1, 0, 1, 2, 1},
                                 {1, 0, 1, 2, 2},
                                 {1, 0, 1, 2, 3},
                                 {1, 0, 2, 0, 1},
                                 {1, 0, 2, 0, 2},
                                 {1, 0, 2, 0, 3},
                                 {1, 0, 2, 1, 1},
                                 {1, 0, 2, 1, 2},
                                 {1, 0, 2, 1, 3},
                                 {1, 0, 2, 2, 1},
                                 {1, 0, 2, 2, 2},
                                 {1, 0, 2, 2, 3},
                                 {1, 1, 0, 0, 1},
                                 {1, 1, 0, 0, 2},
                                 {1, 1, 0, 0, 3},
                                 {1, 1, 0, 1, 1},
                                 {1, 1, 0, 1, 2},
                                 {1, 1, 0, 1, 3},
                                 {1, 1, 0, 2, 1},
                                 {1, 1, 0, 2, 2},
                                 {1, 1, 0, 2, 3},
                                 {1, 1, 1, 0, 1},
                                 {1, 1, 1, 0, 2},
                                 {1, 1, 1, 0, 3},
                                 {1, 1, 1, 1, 1},
                                 {1, 1, 1, 1, 2},
                                 {1, 1, 1, 1, 3},
                                 {1, 1, 1, 2, 1},
                                 {1, 1, 1, 2, 2},
                                 {1, 1, 1, 2, 3},
                                 {1, 1, 2, 0, 1},
                                 {1, 1, 2, 0, 2},
                                 {1, 1, 2, 0, 3},
                                 {1, 1, 2, 1, 1},
                                 {1, 1, 2, 1, 2},
                                 {1, 1, 2, 1, 3},
                                 {1, 1, 2, 2, 1},
                                 {1, 1, 2, 2, 2},
                                 {1, 1, 2, 2, 3},
                                 {1, 2, 0, 0, 1},
                                 {1, 2, 0, 0, 2},
                                 {1, 2, 0, 0, 3},
                                 {1, 2, 0, 1, 1},
                                 {1, 2, 0, 1, 2},
                                 {1, 2, 0, 1, 3},
                                 {1, 2, 0, 2, 1},
                                 {1, 2, 0, 2, 2},
                                 {1, 2, 0, 2, 3},
                                 {1, 2, 1, 0, 1},
                                 {1, 2, 1, 0, 2},
                                 {1, 2, 1, 0, 3},
                                 {1, 2, 1, 1, 1},
                                 {1, 2, 1, 1, 2},
                                 {1, 2, 1, 1, 3},
                                 {1, 2, 1, 2, 1},
                                 {1, 2, 1, 2, 2},
                                 {1, 2, 1, 2, 3},
                                 {1, 2, 2, 0, 1},
                                 {1, 2, 2, 0, 2},
                                 {1, 2, 2, 0, 3},
                                 {1, 2, 2, 1, 1},
                                 {1, 2, 2, 1, 2},
                                 {1, 2, 2, 1, 3},
                                 {1, 2, 2, 2, 1},
                                 {1, 2, 2, 2, 2},
                                 {1, 2, 2, 2, 3},
                                 {2, 0, 0, 0, 1},
                                 {2, 0, 0, 0, 2},
                                 {2, 0, 0, 0, 3},
                                 {2, 0, 0, 1, 1},
                                 {2, 0, 0, 1, 2},
                                 {2, 0, 0, 1, 3},
                                 {2, 0, 0, 2, 1},
                                 {2, 0, 0, 2, 2},
                                 {2, 0, 0, 2, 3},
                                 {2, 0, 1, 0, 1},
                                 {2, 0, 1, 0, 2},
                                 {2, 0, 1, 0, 3},
                                 {2, 0, 1, 1, 1},
                                 {2, 0, 1, 1, 2},
                                 {2, 0, 1, 1, 3},
                                 {2, 0, 1, 2, 1},
                                 {2, 0, 1, 2, 2},
                                 {2, 0, 1, 2, 3},
                                 {2, 0, 2, 0, 1},
                                 {2, 0, 2, 0, 2},
                                 {2, 0, 2, 0, 3},
                                 {2, 0, 2, 1, 1},
                                 {2, 0, 2, 1, 2},
                                 {2, 0, 2, 1, 3},
                                 {2, 0, 2, 2, 1},
                                 {2, 0, 2, 2, 2},
                                 {2, 0, 2, 2, 3},
                                 {2, 1, 0, 0, 1},
                                 {2, 1, 0, 0, 2},
                                 {2, 1, 0, 0, 3},
                                 {2, 1, 0, 1, 1},
                                 {2, 1, 0, 1, 2},
                                 {2, 1, 0, 1, 3},
                                 {2, 1, 0, 2, 1},
                                 {2, 1, 0, 2, 2},
                                 {2, 1, 0, 2, 3},
                                 {2, 1, 1, 0, 1},
                                 {2, 1, 1, 0, 2},
                                 {2, 1, 1, 0, 3},
                                 {2, 1, 1, 1, 1},
                                 {2, 1, 1, 1, 2},
                                 {2, 1, 1, 1, 3},
                                 {2, 1, 1, 2, 1},
                                 {2, 1, 1, 2, 2},
                                 {2, 1, 1, 2, 3},
                                 {2, 1, 2, 0, 1},
                                 {2, 1, 2, 0, 2},
                                 {2, 1, 2, 0, 3},
                                 {2, 1, 2, 1, 1},
                                 {2, 1, 2, 1, 2},
                                 {2, 1, 2, 1, 3},
                                 {2, 1, 2, 2, 1},
                                 {2, 1, 2, 2, 2},
                                 {2, 1, 2, 2, 3},
                                 {2, 2, 0, 0, 1},
                                 {2, 2, 0, 0, 2},
                                 {2, 2, 0, 0, 3},
                                 {2, 2, 0, 1, 1},
                                 {2, 2, 0, 1, 2},
                                 {2, 2, 0, 1, 3},
                                 {2, 2, 0, 2, 1},
                                 {2, 2, 0, 2, 2},
                                 {2, 2, 0, 2, 3},
                                 {2, 2, 1, 0, 1},
                                 {2, 2, 1, 0, 2},
                                 {2, 2, 1, 0, 3},
                                 {2, 2, 1, 1, 1},
                                 {2, 2, 1, 1, 2},
                                 {2, 2, 1, 1, 3},
                                 {2, 2, 1, 2, 1},
                                 {2, 2, 1, 2, 2},
                                 {2, 2, 1, 2, 3},
                                 {2, 2, 2, 0, 1},
                                 {2, 2, 2, 0, 2},
                                 {2, 2, 2, 0, 3},
                                 {2, 2, 2, 1, 1},
                                 {2, 2, 2, 1, 2},
                                 {2, 2, 2, 1, 3},
                                 {2, 2, 2, 2, 1},
                                 {2, 2, 2, 2, 2},
                                 {2, 2, 2, 2, 3}};

    vector<int> expected = {0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 2, 0, 1, 1, 0, 1, 1, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1};

    for (int i = 0; i < input.size(); i++)
    {
        LL n1 = input[i][0];
        LL k1 = input[i][1];
        LL n2 = input[i][2];
        LL k2 = input[i][3];
        LL n = input[i][4];

        LL ans = solve(n1, k1, n2, k2, n);

        if (ans == expected[i])
            printf("Correct: %d\n", i);
        else
        {
            printf("Wrong: n1=%lld, k1=%lld, n2=%lld, k2=%lld, n=%lld\n", n1, k1, n2, k2, n);
            break;
        }
    }

    return 0;
}
